<?xml version="1.0" encoding="utf-8"?>

<odoo>
    <template id="template_header_default" inherit_id="website.template_header_default"
              name="Ilmin Template Header Default" active="True">
        <xpath expr='//t[@t-call="website.placeholder_header_call_to_action"]' position="replace">
        </xpath>
        <xpath expr="//t[@t-foreach='website.menu_id.child_id']" position="after">
            <t t-set="website_sale_order" t-value="website.sale_get_order()"/>
            <span t-attf-class="ml-lg-auto d-none d-lg-inline font-weight-bold text-muted nav-link my_cart_amount"
                  t-esc="website_sale_order.amount_total"
                  t-options="{'widget': 'monetary', 'display_currency': website.currency_id}"></span>
        </xpath>
        <xpath expr='//t[@t-call="portal.placeholder_user_sign_in"]' position="replace">
            <t t-call="portal.placeholder_user_sign_in">
                <t t-set="_item_class" t-valuef="nav-item"/>
                <t t-set="_link_class" t-valuef="nav-link font-weight-bold"/>
            </t>
        </xpath>
        <xpath expr='//t[@t-call="portal.user_dropdown"]' position="replace">
            <t t-call="portal.user_dropdown">

                <t t-set="_user_name" t-value="true"/>
                <t t-set="_item_class" t-valuef="nav-item dropdown"/>
                <t t-set="_link_class" t-valuef="nav-link font-weight-bold"/>
            </t>
        </xpath>

    </template>
    <template id="no_footer" inherit_id="website.layout">
        <xpath expr="//div[@id='footer']" position="replace">
        </xpath>
    </template>

    <template id="products_item" name="Ilmimn Products Item">

        <t t-set="product_href"
           t-value="keep(product.website_url, page=(pager['page']['num'] if pager['page']['num']&gt;1 else None))"/>

        <t t-set="combination_info"
           t-value="product._get_combination_info(only_template=True, add_qty=add_qty or 1, pricelist=pricelist)"/>
        <t t-set="website_sale_order" t-value="website.sale_get_order()"/>

        <t t-set="product_template"
           t-value="website_sale_order._get_product_tmlp_info(order_id=website_sale_order.id, product_templ_id=product.id)"/>
        <a class="o_product_link css_editable_mode_hidden" t-att-href="product_href"/>
        <div class="card-body p-0">
            <div class="p-0 product_name">
                <div class="p-0 o_wsale_product_information_text">
                    <h6 class="o_wsale_products_item_title mb-1">
                        <a class="text-primary text-decoration-none" itemprop="name" t-att-href="product_href"
                           t-att-content="product.name" t-field="product.name"/>
                        <span class="total_product" style="display:none;">
                            TOTAL: <span
                                t-esc="abs(product_template['order_line_product_tmlp_total'])"
                                t-options="{'widget': 'monetary', 'display_currency': website.currency_id}"/>
                        </span>
                    </h6>
                </div>

            </div>

            <div class="p-0 o_wsale_product_information_text">
                <t t-set="attribute_exclusions"
                   t-value="product._get_attribute_exclusions()"/>
                <t t-set="filtered_sorted_variants" t-value="product._get_possible_variants_sorted()"/>
                <div t-foreach="filtered_sorted_variants" t-as="variant_id"
                     class="p-1">
                    <t t-set="template_combination_info"
                       t-value="product._get_combination_info(only_template=True, add_qty=add_qty, pricelist=pricelist)"/>
                    <t t-set="combination_info"
                       t-value="variant_id._get_combination_info_variant(add_qty=add_qty, pricelist=pricelist)"/>
                    <t t-set="line_info"
                       t-value="website_sale_order._get_line_info(order_id=website_sale_order.id, product_id=variant_id.id)"/>
                    <input type="hidden" name="product_id" t-att-value="variant_id.id"/>
                    <table class="table table-striped table-sm mb-0 table-desktop">
                        <tbody>
                            <tr>
                                <td class="text-center td-price p-0 m-0">
                                    <span class="product_variant_price"
                                          t-esc="abs(combination_info['price'])"
                                          t-options="{'widget': 'monetary', 'display_currency': website.currency_id}"/>
                                </td>
                                <td class="p-0 m-0 td-variant-name">

                                    <span
                                            t-esc="', '.join(variant_id.product_template_attribute_value_ids.mapped('name'))"/>
                                </td>
                                <td class="p-0 m-0 td-add-mass">

                                    <span>
                                        <button
                                                class="btn btn-secondary float_left d-md-inline-block add_mass quick_add_to_cart"
                                                aria-label="Add one" title="Add one" t-attf-qty="1">
                                            +1
                                        </button>
                                        <button
                                                class="btn btn-secondary float_left d-md-inline-block add_mass quick_add_to_cart"
                                                aria-label="Add Three" title="Add Three" t-attf-qty="3">
                                            +3
                                        </button>
                                        <button
                                                class="btn btn-secondary float_left d-md-inline-block add_mass quick_add_to_cart"
                                                aria-label="Add Six" title="Add Six" t-attf-qty="6">
                                            +6
                                        </button>

                                    </span>

                                </td>
                                <td class="text-center td-qty p-0 m-0">

                                    <div t-att-class="'css_quantity input-group mx-auto justify-content-center invisible'  if line_info['order_line_product_qty'] == 0 else 'css_quantity input-group mx-auto justify-content-center'"
                                         t-if="product.visible_qty_configurator">
                                        <div class="input-group-prepend">
                                            <button t-attf-href="#"
                                                    class="btn btn-primary js_add_cart_json_ilmin d-md-inline-block quick_add_to_cart"
                                                    aria-label="Remove one" title="Remove one">
                                                <i class="fa fa-minus"></i>
                                            </button>
                                        </div>
                                        <input type="text" class="js_quantity form-control quantity"
                                               data-min="0" name="add_qty"
                                               t-att-value="line_info['order_line_product_qty'] or 0"
                                        />
                                        <div></div>
                                        <div class="input-group-append">
                                            <button t-attf-href="#"
                                                    class="btn btn-primary float_left js_add_cart_json_ilmin d-md-inline-block quick_add_to_cart"
                                                    aria-label="Add one" title="Add one">
                                                <i class="fa fa-plus"></i>
                                            </button>
                                        </div>

                                    </div>

                                </td>
                                <td class="td-action p-0 m-0">
                                    <span t-att-class="'action-trash invisible'  if line_info['order_line_product_qty'] == 0 else 'action-trash'">
                                        <a href='#' aria-label="Remove from cart"
                                           title="Remove from cart"
                                           class='js_delete_product_ilmin no-decoration quick_add_to_cart'><big><i
                                                class='fa fa-trash-o'></i></big></a>
                                    </span>
                                </td>
                                <td class="text-center td-price p-0 m-0">
                                    <span
                                            class="line_total_price"
                                            t-esc="abs(line_info['order_line_product_total']) or 0"
                                            t-options='{
                                                   "widget": "monetary",
                                                   "display_currency": product.currency_id,
                                               }'/>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                    <table class="table table-striped table-sm mb-0 table-phone">
                        <tbody>
                            <tr>
                                <td class="p-0 m-0 td-variant-name">
                                    <span>
                                        <span
                                                t-esc="abs(combination_info['price'])"
                                                t-options="{'widget': 'monetary', 'display_currency': website.currency_id}"/>
                                    </span>
                                    <span
                                            t-esc="', '.join(variant_id.product_template_attribute_value_ids.mapped('name'))"/>
                                </td>
                                <td class="p-0 m-0 td-add-mass">
                                    <span>
                                        <button
                                                class="btn btn-secondary float_left d-md-inline-block add_mass quick_add_to_cart"
                                                aria-label="Add one" title="Add one" t-attf-qty="1">
                                            +1
                                        </button>
                                        <button
                                                class="btn btn-secondary float_left d-md-inline-block add_mass quick_add_to_cart"
                                                aria-label="Add Three" title="Add Three" t-attf-qty="3">
                                            +3
                                        </button>
                                        <button
                                                class="btn btn-secondary float_left d-md-inline-block add_mass quick_add_to_cart"
                                                aria-label="Add Six" title="Add Six" t-attf-qty="6">
                                            +6
                                        </button>

                                    </span>

                                </td>
                                <td class="text-center td-qty p-0 m-0">
                                    <div t-att-class="'css_quantity input-group mx-auto justify-content-center invisible'  if line_info['order_line_product_qty'] == 0 else 'css_quantity input-group mx-auto justify-content-center'"
                                         t-if="product.visible_qty_configurator">
                                        <div class="input-group-prepend">
                                            <button t-attf-href="#"
                                                    class="btn btn-primary js_add_cart_json_ilmin d-md-inline-block quick_add_to_cart"
                                                    aria-label="Remove one" title="Remove one">
                                                <i class="fa fa-minus"></i>
                                            </button>
                                        </div>
                                        <input type="text" class="js_quantity form-control quantity"
                                               data-min="0" name="add_qty"
                                               t-att-value="line_info['order_line_product_qty'] or 0"/>
                                        <div></div>
                                        <div class="input-group-append">
                                            <button t-attf-href="#"
                                                    class="btn btn-primary float_left js_add_cart_json_ilmin d-md-inline-block quick_add_to_cart"
                                                    aria-label="Add one" title="Add one">
                                                <i class="fa fa-plus"></i>
                                            </button>
                                        </div>

                                    </div>

                                </td>
                                <td class="td-action p-0 m-0">

                                    <span t-att-class="'action-trash invisible'  if line_info['order_line_product_qty'] == 0 else 'action-trash'">

                                        <a href='#' aria-label="Remove from cart"
                                           title="Remove from cart"
                                           class='js_delete_product_ilmin no-decoration quick_add_to_cart'><big><i
                                                class='fa fa-trash-o'></i></big></a>
                                    </span>
                                </td>
                            </tr>
                        </tbody>
                    </table>

                </div>
            </div>
        </div>

        <t t-set="bg_color" t-value="td_product['ribbon']['bg_color'] or ''"/>
        <t t-set="text_color" t-value="td_product['ribbon']['text_color']"/>
        <t t-set="bg_class" t-value="td_product['ribbon']['html_class']"/>
        <span t-attf-class="o_ribbon #{bg_class}"
              t-attf-style="#{text_color and ('color: %s; ' % text_color)}#{bg_color and 'background-color:' + bg_color}"
              t-out="td_product['ribbon']['html'] or ''"/>
    </template>


    <template id="products" inherit_id="website_sale.products" name="Ilmin Products">
        <xpath expr='//t[@t-call="website_sale.pricelist_list"]' position="replace">
        </xpath>


        <xpath expr='//t[@t-call="website_sale.products_item"]' position="replace">
            <t t-call="theme_gold_ilmin.products_item">
            </t>
        </xpath>
        <xpath expr="//div[contains(@t-attf-class, 'o_wsale_product_grid_wrapper')]" position="attributes">
            <attribute name="t-attf-class" remove="o_wsale_product_grid_wrapper" separator=" "/>
        </xpath>
    </template>


    <template id="login" inherit_id="web.login" name="Login Inherit">
        <xpath expr="//label[@for='login']" position="replace">
        </xpath>
        <xpath expr="//label[@for='password']" position="replace">
        </xpath>
        <xpath expr="//form[@class='oe_login_form']" position="before">
            <div class="logo_login">
                <div>
                    <img src="/theme_gold_ilmin/static/src/img/parfum.svg"/>

                </div>
            </div>
        </xpath>

    </template>


    <template id="cart_lines" inherit_id="website_sale.cart_lines" name="Ilmin cart lines">
        <xpath expr="//table[@id='cart_products']" position="replace">
            <table class="mb16 table table-striped table-sm js_cart_lines" id="cart_products"
                   t-if="website_sale_order and website_sale_order.website_order_line">
                <thead>
                    <tr>
                        <th class="td-img">Product</th>
                        <th class="text-center td-qty">
                            <t t-set="show_qty" t-value="is_view_active('website_sale.product_quantity')"/>
                            <t t-if="show_qty">
                                Quantity
                            </t>
                        </th>
                        <th class="text-center td-price">Price</th>
                        <th class="text-center td-action"></th>
                    </tr>
                </thead>
                <tbody>
                    <t t-foreach="website_sale_order.website_order_line" t-as="line">
                        <tr t-att-class="'optional_product info' if line.linked_line_id else None">
                            <td colspan="2" t-if="not line.product_id.product_tmpl_id" class='td-img'></td>
                            <td t-if="line.product_id.product_tmpl_id" class='td-product_name'>
                                <div>
                                    <t t-call="website_sale.cart_line_product_link">
                                        <strong t-field="line.name_short"/>
                                    </t>
                                </div>
                                <t t-call="website_sale.cart_line_description_following_lines">
                                    <t t-set="div_class" t-value="'d-none d-md-block'"/>
                                </t>
                            </td>
                            <td class="text-center td-qty">
                                <div class="css_quantity input-group mx-auto justify-content-center">
                                    <t t-if="not line._is_not_sellable_line()">
                                        <t t-if="show_qty">
                                            <div class="input-group-prepend">
                                                <a t-attf-href="#"
                                                   class="btn btn-link js_add_cart_json d-none d-md-inline-block"
                                                   aria-label="Remove one" title="Remove one">
                                                    <i class="fa fa-minus"></i>
                                                </a>
                                            </div>
                                            <input type="text" class="js_quantity form-control quantity"
                                                   t-att-data-line-id="line.id"
                                                   t-att-data-product-id="line.product_id.id"
                                                   t-att-value="int(line.product_uom_qty) == line.product_uom_qty and int(line.product_uom_qty) or line.product_uom_qty"/>
                                            <div class="input-group-append">
                                                <a t-attf-href="#"
                                                   class="btn btn-link float_left js_add_cart_json d-none d-md-inline-block"
                                                   aria-label="Add one" title="Add one">
                                                    <i class="fa fa-plus"></i>
                                                </a>
                                            </div>
                                        </t>
                                        <t t-else="">
                                            <input type="hidden" class="js_quantity form-control quantity"
                                                   t-att-data-line-id="line.id"
                                                   t-att-data-product-id="line.product_id.id"
                                                   t-att-value="int(line.product_uom_qty) == line.product_uom_qty and int(line.product_uom_qty) or line.product_uom_qty"/>
                                        </t>
                                    </t>
                                    <t t-else="">
                                        <span class="text-muted w-100" t-esc="int(line.product_uom_qty)"/>
                                        <input type="hidden" class="js_quantity form-control quantity"
                                               t-att-data-line-id="line.id" t-att-data-product-id="line.product_id.id"
                                               t-att-value="line.product_uom_qty"/>
                                    </t>
                                </div>
                            </td>
                            <td class="text-center td-price" name="price">
                                <t t-set="combination"
                                   t-value="line.product_id.product_template_attribute_value_ids + line.product_no_variant_attribute_value_ids"/>
                                <t t-set="combination_info"
                                   t-value="line.product_id.product_tmpl_id._get_combination_info(combination, pricelist=website_sale_order.pricelist_id, add_qty=line.product_uom_qty)"/>

                                <t t-set="list_price_converted"
                                   t-value="website.currency_id._convert(combination_info['list_price'], website_sale_order.currency_id, website_sale_order.company_id, date)"/>
                                <t groups="account.group_show_line_subtotals_tax_excluded"
                                   t-if="(website_sale_order.pricelist_id.discount_policy == 'without_discount' and website_sale_order.currency_id.compare_amounts(list_price_converted, line.price_reduce_taxexcl) == 1) or website_sale_order.currency_id.compare_amounts(line.price_unit, line.price_reduce) == 1"
                                   name="order_line_discount">
                                    <del t-attf-class="#{'text-danger mr8'}" style="white-space: nowrap;"
                                         t-esc="list_price_converted"
                                         t-options="{'widget': 'monetary', 'display_currency': website_sale_order.currency_id}"/>
                                </t>
                                <span t-field="line.price_reduce_taxexcl" style="white-space: nowrap;"
                                      t-options="{'widget': 'monetary', 'display_currency': website_sale_order.currency_id}"
                                      groups="account.group_show_line_subtotals_tax_excluded"/>
                                <t groups="account.group_show_line_subtotals_tax_included"
                                   t-if="(website_sale_order.pricelist_id.discount_policy == 'without_discount' and website_sale_order.currency_id.compare_amounts(list_price_converted, line.price_reduce_taxinc) == 1) or website_sale_order.currency_id.compare_amounts(line.price_unit, line.price_reduce) == 1"
                                   name="order_line_discount">
                                    <del t-attf-class="#{'text-danger mr8'}" style="white-space: nowrap;"
                                         t-esc="list_price_converted"
                                         t-options="{'widget': 'monetary', 'display_currency': website_sale_order.currency_id}"/>
                                </t>
                                <span t-field="line.price_reduce_taxinc" style="white-space: nowrap;"
                                      t-options="{'widget': 'monetary', 'display_currency': website_sale_order.currency_id}"
                                      groups="account.group_show_line_subtotals_tax_included"/>
                                <small t-if="not line._is_not_sellable_line() and line.product_id.base_unit_price"
                                       class="cart_product_base_unit_price d-block text-muted"
                                       groups="website_sale.group_show_uom_price">
                                    <t t-call='website_sale.base_unit_price'><t t-set='product'
                                                                                t-value='line.product_id'/></t>
                                </small>
                            </td>
                            <td class="td-action">
                                <a href='#' aria-label="Remove from cart" title="Remove from cart"
                                   class='js_delete_product no-decoration'><small><i
                                        class='fa fa-trash-o'></i></small></a>
                            </td>
                        </tr>
                    </t>
                </tbody>
            </table>

        </xpath>


    </template>

    <template id="cart_summary" inherit_id="website_sale.cart_summary"
              name="Ilmin cart summary">
        <xpath expr="//table[@id='cart_products']" position="replace">
            <table class="table table-striped table-sm" id="cart_products"
                   t-if="website_sale_order and website_sale_order.website_order_line">
                <thead>
                    <tr>
                        <th class="border-top-0 td-img">Product</th>
                        <th class="border-top-0 td-qty">Quantity</th>
                        <th class="border-top-0 text-center td-price">Price</th>
                    </tr>
                </thead>
                <tbody>
                    <tr t-foreach="website_sale_order.website_order_line" t-as="line">
                        <td colspan="2" t-if="not line.product_id.product_tmpl_id"></td>
                        <td class='td-product_name' t-if="line.product_id.product_tmpl_id">
                            <div>
                                <strong t-field="line.name_short"/>
                            </div>
                        </td>
                        <td class='td-qty'>
                            <div t-esc="line.product_uom_qty"/>
                        </td>
                        <td class="text-center td-price">
                            <span t-field="line.price_reduce_taxexcl" style="white-space: nowrap;"
                                  t-options="{'widget': 'monetary', 'display_currency': website_sale_order.currency_id}"
                                  groups="account.group_show_line_subtotals_tax_excluded"/>
                            <span t-field="line.price_reduce_taxinc" style="white-space: nowrap;"
                                  t-options="{'widget': 'monetary', 'display_currency': website_sale_order.currency_id}"
                                  groups="account.group_show_line_subtotals_tax_included"/>
                        </td>
                    </tr>
                </tbody>
            </table>

        </xpath>


    </template>

    <template id="cart_popover" inherit_id="website_sale.cart_popover" name="Ilmin Cart Popover">
        <xpath expr='//div[hasclass("cart_line")]' position="replace">

            <div class="form-row mb8 cart_line">
                <div class="col-12">
                    <div>
                        <t t-call="website_sale.cart_line_product_link">
                            <span class="h6" t-esc="line.name_short"/>
                        </t>
                    </div>
                    Qty: <t
                        t-esc="int(line.product_uom_qty) == line.product_uom_qty and int(line.product_uom_qty) or line.product_uom_qty"/>
                </div>
            </div>

        </xpath>

    </template>
</odoo>